<!DOCTYPE html>
<html>
<head>
    <style>
        h1 {
            text-align: center;
        }
    </style>

    <script>
        async function createAccount() {
            var username = document.getElementById("username").value;
            var password = document.getElementById("password").value;
            var confirmPassword = document.getElementById("confirmPassword").value;

            var error = document.getElementById("error");
            var success = document.getElementById("success");

            error.innerText = "";
            success.innerText = "";


            if (username === "" || password === "" || confirmPassword === "") {
                error.innerText = "Please fill out all fields";
                return;
            }

            if (password !== confirmPassword) {
                error.innerText = "Passwords do not match.";
                return;
            }

            try {

                var res = await fetch("/api/create_account", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ username, password })
                });

                var data = await res.json();

                if (!res.ok) {
                    error.innerText = data.error || "some error idk ";
                    return;
                }

                success.innerText = "Account created successfully!";

            } catch (err) {
                console.log(err);
                error.innerText = "some error idk (2)";
            }
        }
    </script>
</head>

<body>
    <h1>Thanks for choosing Readitd!</h1>

    <form onsubmit="return false;">
        <label for="username">Choose a username for your account</label><br>
        <input type="text" id="username"><br><br>

        <label for="password">Choose a password here</label><br>
        <input type="password" id="password"><br><br>

        <label for="confirmPassword">Retype your password here to confirm</label><br>
        <input type="password" id="confirmPassword"><br><br>

        <button onclick="createAccount()">Create Account</button>
    </form>

    <p id="error"></p>
    <p id="success"></p>
</body>
</html>
